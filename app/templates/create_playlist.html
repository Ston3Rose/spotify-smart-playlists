<h2>➕ Create New Smart Playlist</h2>
<form method="post">
  <label>
    Playlist Name:
    <input type="text" name="name" required>
  </label>
  <br><br>

  <label>
    Type:
    <select name="type" required>
      <option value="most_played">Most Played</option>
      <option value="never_played">Never Played</option>
      <option value="recently_liked">Recently Liked</option>
      <option value="played_once">Played Once</option>
      <option value="oldest_played">Oldest Played</option>
    </select>
  </label>
  <br><br>

  <label>
    Track Limit:
    <input type="number" name="limit" min="1" max="9000" value="50" required>
  </label>
  <br><br>

  <hr>
  <h3>Filter Rules</h3>
  <label>
    Match 
    <select name="match" id="match" required>
      <option value="all">all</option>
      <option value="any">any</option>
    </select>
    of the following rules:
  </label>

  <div id="rules-container">
    <div class="rule-row">
      <select name="field">
        <option value="artist">Artist</option>
        <option value="album">Album</option>
        <option value="track">Track</option>
        <option value="is_liked">Is Liked</option>
        <option value="date_added">Date Added</option>
        <option value="plays">Number of Plays</option>
        <option value="last_played">Last Played</option>
        <option value="first_played">First Played</option>
      </select>

      <select name="operator">
        <option value="is">is</option>
        <option value="is_not">is not</option>
        <option value="contains">contains</option>
        <option value="not_contains">does not contain</option>
        <option value="gt">greater than</option>
        <option value="lt">less than</option>
      </select>

      <input type="text" name="value">
      <button type="button" onclick="removeRule(this)">−</button>
    </div>
  </div>

  <button type="button" onclick="addRule()">➕ Add Rule</button>

  <script>
    function addRule() {
      const container = document.getElementById('rules-container');
      const rule = container.querySelector('.rule-row').cloneNode(true);
      rule.querySelectorAll('input').forEach(input => input.value = '');
      container.appendChild(rule);
    }

    function removeRule(button) {
      const container = document.getElementById('rules-container');
      if (container.children.length > 1) {
        button.parentElement.remove();
      }
    }
  </script>

</form>
  <input type="hidden" name="rules_json" id="rules_json">
  <button type="submit">🎶 Create Playlist</button>

<p><a href="/dashboard/playlists">⬅️ Back to Playlists</a></p>